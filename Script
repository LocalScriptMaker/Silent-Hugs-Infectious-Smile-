-- U can raise high lvl if will play with it LOL :D

-- Variables

local Plr = game.Players.LocalPlayer

local Mouse = Plr:GetMouse()
local Camera = game.Workspace.CurrentCamera

local Exp: IntValue = Plr.Stats.Exp
local Lvl: IntValue = Plr.Stats.Level
local MonthlyInfects: StringValue = Plr.Stats.MonthlyInfects

local TotalInfects = Plr.Stats.TotalInfects

--<< Custom Variables >>-- (Customizable)

local Insta_Hug = true -- A mode that allows you to capture humans without recharging the ability and without showing animation (true / false)
local No_Grab_Cooldown = false -- A mode that sets the reload time after capture to be equal to the playback time of the capture animation (true / false)
local Extended_Hitboxes = true -- Enlarges the Infect Part in your character's body to certain sizes shown below.

local Grab_Anim_Length = 0.4 -- (Default: 0.666666686538816 or 0.4 (better)) approximate time for playing the capture animation (can be changed by setting any number)

local Infect_Part_X = 4 -- Length (X) It is advisable to indicate less than 15
local Infect_Part_Y = 6 -- Height (Y) It is advisable to indicate less than 15
local Infect_Part_Z = 4 -- Width (Z) It is advisable to indicate less than 15

local Weld_Offset_X = 0 -- You don’t have to change this number, the system just works more correctly with it 
local Weld_Offset_Y = -0.5 -- You don’t have to change this number, the system just works more correctly with it
local Weld_Offset_Z = -0.5 -- You don’t have to change this number, the system just works more correctly with it

-- Extra Variables

local Stats_Gui = Instance.new("ScreenGui")
Stats_Gui.Name = "Stats_Gui"
Stats_Gui.ResetOnSpawn = false
Stats_Gui.IgnoreGuiInset = true
Stats_Gui.Parent = Plr.PlayerGui

local Main_Frame = Instance.new("Frame")
Main_Frame.Name = "Main_Frame"
Main_Frame.BackgroundTransparency = 1
Main_Frame.Position = UDim2.new(0, 0, 0.378, 0)
Main_Frame.Size = UDim2.new(0.09, 0, 0.251, 0)
Main_Frame.Parent = Stats_Gui

local EXP_Title = Instance.new("TextLabel")
EXP_Title.Name = "EXP_Title"
EXP_Title.BackgroundTransparency = 1
EXP_Title.Position = UDim2.new(0, 0, 0, 0)
EXP_Title.Size = UDim2.new(1, 0, 0.167, 0)
EXP_Title.FontFace.Bold = true
EXP_Title.RichText = true
EXP_Title.TextScaled = true
EXP_Title.TextStrokeTransparency = 0
EXP_Title.TextColor3 = Color3.fromRGB(255, 0, 0)
EXP_Title.Text = "EXP"
EXP_Title.Parent = Main_Frame

local EXP_Counter = Instance.new("TextLabel")
EXP_Counter.Name = "EXP_Counter"
EXP_Counter.BackgroundTransparency = 1
EXP_Counter.Position = UDim2.new(0, 0, 0.167, 0)
EXP_Counter.Size = UDim2.new(1, 0, 0.167, 0)
EXP_Counter.FontFace.Bold = true
EXP_Counter.RichText = true
EXP_Counter.TextScaled = true
EXP_Counter.TextStrokeTransparency = 0
EXP_Counter.TextColor3 = Color3.fromRGB(0, 0, 255)
EXP_Counter.Text = Exp.Value
EXP_Counter.Parent = Main_Frame

local Infects_Title = Instance.new("TextLabel")
Infects_Title.Name = "Infects_Title"
Infects_Title.BackgroundTransparency = 1
Infects_Title.Position = UDim2.new(0, 0, 0.327, 0)
Infects_Title.Size = UDim2.new(1, 0, 0.167, 0)
Infects_Title.FontFace.Bold = true
Infects_Title.RichText = true
Infects_Title.TextScaled = true
Infects_Title.TextStrokeTransparency = 0
Infects_Title.TextColor3 = Color3.fromRGB(255, 0, 0)
Infects_Title.Text = "INFECTS"
Infects_Title.Parent = Main_Frame

local Infects_Counter = Instance.new("TextLabel")
Infects_Counter.Name = "Infects_Counter"
Infects_Counter.BackgroundTransparency = 1
Infects_Counter.Position = UDim2.new(0, 0, 0.486, 0)
Infects_Counter.Size = UDim2.new(1, 0, 0.167, 0)
Infects_Counter.FontFace.Bold = true
Infects_Counter.RichText = true
Infects_Counter.TextScaled = true
Infects_Counter.TextStrokeTransparency = 0
Infects_Counter.TextColor3 = Color3.fromRGB(255, 255, 0)
Infects_Counter.Text = TotalInfects.Value
Infects_Counter.Parent = Main_Frame

local MonthlyInfects_Title = Instance.new("TextLabel")
MonthlyInfects_Title.Name = "MonthlyInfects_Title"
MonthlyInfects_Title.BackgroundTransparency = 1
MonthlyInfects_Title.Position = UDim2.new(0, 0, 0.652, 0)
MonthlyInfects_Title.Size = UDim2.new(1, 0, 0.167, 0)
MonthlyInfects_Title.FontFace.Bold = true
MonthlyInfects_Title.RichText = true
MonthlyInfects_Title.TextScaled = true
MonthlyInfects_Title.TextStrokeTransparency = 0
MonthlyInfects_Title.TextColor3 = Color3.fromRGB(255, 0, 0)
MonthlyInfects_Title.Text = "MOUNTHLY INFECTS"
MonthlyInfects_Title.Parent = Main_Frame

local MonthlyInfects_Counter = Instance.new("TextLabel")
MonthlyInfects_Counter.Name = "MonthlyInfects_Counter"
MonthlyInfects_Counter.BackgroundTransparency = 1
MonthlyInfects_Counter.Position = UDim2.new(0, 0, 0.819, 0)
MonthlyInfects_Counter.Size = UDim2.new(1, 0, 0.167, 0)
MonthlyInfects_Counter.FontFace.Bold = true
MonthlyInfects_Counter.RichText = true
MonthlyInfects_Counter.TextScaled = true
MonthlyInfects_Counter.TextStrokeTransparency = 0
MonthlyInfects_Counter.TextColor3 = Color3.fromRGB(255, 85, 0)
local CurrentMonthlyInfects = MonthlyInfects.Value:split("_")
MonthlyInfects_Counter.Text = CurrentMonthlyInfects[2]
MonthlyInfects_Counter.Parent = Main_Frame

-- Main Function --

Mouse.Button1Down:Connect(function()

	if Plr.Team == game.Teams.Smiling and Plr.Character.Humanoid.Health ~= 0 and Plr.Character.Stats.Downed.Value == false and Plr.Character.Stats.Ragdoll.Value == false then

		if Insta_Hug == true and No_Grab_Cooldown == false then

			if Plr.PlayerGui.DurabilityGui.CoolDownFrame.Progress.Size == UDim2.new(0, 0, 0, 0) then

				task.wait(Grab_Anim_Length)

			else

				task.wait()

			end	

			Plr.Character.Infected.InfectEvent:FireServer()

		end

	end	

end)

Plr.Changed:Connect(function(Team)

	if Plr.Team == game.Teams.Smiling and Plr.Character.Humanoid.Health ~= 0 and Plr.Character:FindFirstChild("Torso") then

		if Insta_Hug == false and No_Grab_Cooldown == true then

			Plr.Character.Infected.Infect.Cooldown.Value = Grab_Anim_Length

		end	
		
		if Extended_Hitboxes == true then

			task.wait(0.5)

			local Infect_Part: Part = Plr.Character.Torso:FindFirstChild("Part")
			local Infect_Weld: Weld = Plr.Character.Torso:FindFirstChild("Weld")

			Infect_Part.Size = Vector3.new(Infect_Part_X, Infect_Part_Y, Infect_Part_Z)

			Infect_Weld.C0 = CFrame.new(Weld_Offset_X, Weld_Offset_Y, Weld_Offset_Z)
			
			local HitBox = Instance.new("SelectionBox")
			HitBox.Name = "HitBox"
			HitBox.LineThickness = 0.15
			HitBox.SurfaceTransparency = 1
			HitBox.Transparency = 0
			HitBox.Visible = true
			HitBox.Adornee = Infect_Part
			HitBox.Parent = Infect_Part
			
		end	

	end

end)

-- Screen Stats Changes

TotalInfects.Changed:Connect(function(Value)

	Infects_Counter.Text = Value

	game.TweenService:Create(game.Lighting, TweenInfo.new(0.25, Enum.EasingStyle.Linear), {Ambient = Color3.fromRGB(255, 0, 0), OutdoorAmbient = Color3.fromRGB(255, 0, 0)}):Play()

	local Hug_sound = Instance.new("Sound")
	Hug_sound.SoundId = "rbxassetid://2866718318"
	Hug_sound.Name = "Hug_Sound"
	Hug_sound.Parent = Stats_Gui
	Hug_sound:Play()
	game.Debris:AddItem(Hug_sound, 2)

	task.wait(0.25)

	game.TweenService:Create(game.Lighting, TweenInfo.new(0.25, Enum.EasingStyle.Linear), {Ambient = Color3.fromRGB(138, 138, 138), OutdoorAmbient = Color3.fromRGB(128, 128, 128)}):Play()

end)

Exp.Changed:Connect(function(Value)

	EXP_Counter.Text = Value

end)

MonthlyInfects.Changed:Connect(function(Value)

	local MonthlyInfects_Table = Value:split("_")

	MonthlyInfects_Counter.Text = MonthlyInfects_Table[2]

end)

-- Admin Chose

local function Admin_Accident(Chose)

	if Chose == "Leave" then

		Plr:Kick("Hope you won't be BANNED, My Lyboomking :)")

	elseif Chose == "Stay" then

		Plr.Character.Humanoid:ChangeState(Enum.HumanoidStateType.Dead)

		script:Destroy()

	end

end	

local Choose_Bindable_1 = Instance.new("BindableFunction")
Choose_Bindable_1.OnInvoke = Admin_Accident

-- High_Lvl_Plr_Chose

local function HighLvl_Accident(Chose)

	if Chose == "Leave" then

		Plr:Kick("Ugh, I hope you didn't get caught, my Lyboomking! :)")
		
		if Chose == "Stay" then
			
			local Script_Music = Instance.new("Sound")
			Script_Music.SoundId = "rbxassetid://1847653078"
			Script_Music.Looped = true
			Script_Music:Play()
			Script_Music.Name = "Script_Music"
			Script_Music.Parent = Stats_Gui

			Plr.Character.Humanoid:ChangeState(Enum.HumanoidStateType.Dead)

			script:Destroy()
			
		end

	end

end	

local Choose_Bindable_2 = Instance.new("BindableFunction")
Choose_Bindable_2.OnInvoke = HighLvl_Accident

-- Plr's_Lvl_Check

local function PlrJoined(PlrName)

	task.wait(5)

	if game.Players:FindFirstChild(PlrName) then

		local Joined_Plr: Player = game.Players:FindFirstChild(PlrName)

		local Lvl = Joined_Plr.leaderstats.Level.Value

		if Lvl >= 50 then

			local High_PlrLvl_Alert = Instance.new("Sound")
			High_PlrLvl_Alert.SoundId = "rbxassetid://6753645454"
			High_PlrLvl_Alert.Volume = 1
			High_PlrLvl_Alert:Play()
			High_PlrLvl_Alert.Name = "High_PlrLvl_Alert"
			High_PlrLvl_Alert.Parent = Stats_Gui
			game.Debris:AddItem(High_PlrLvl_Alert, 2.5)

			game.StarterGui:SetCore("SendNotification", {

				Title = "! " .. Lvl .. " !",
				Text = Joined_Plr.DisplayName .. " | @" .. Joined_Plr.Name .. " | " .. Joined_Plr.UserId,
				Icon = game.Players:GetUserThumbnailAsync(Joined_Plr.UserId, Enum.ThumbnailType.HeadShot, Enum.ThumbnailSize.Size420x420),
				Duration = 10,
				Button1 = "Leave",
				Button2 = "Stay",
				Callback = Choose_Bindable_2

			})

		else

			game.StarterGui:SetCore("SendNotification", {

				Title = "! " .. Lvl .. " !",
				Text = Joined_Plr.DisplayName .. " | @" .. Joined_Plr.Name .. " | " .. Joined_Plr.UserId,
				Icon = game.Players:GetUserThumbnailAsync(Joined_Plr.UserId, Enum.ThumbnailType.HeadShot, Enum.ThumbnailSize.Size420x420),
				Duration = 3,

			})

		end

	end	

end

-- Joined Plr Checker

game.Players.PlayerAdded:Connect(function(Other_Plr)

	local Success, Error = pcall(function()

		local PlrName = Other_Plr.Name

		if Other_Plr:IsInGroup(5054016) then

			local Other_Plr_Rank = Other_Plr:GetRankInGroup(5054016)
			local Other_Plr_Role = Other_Plr:GetRoleInGroup(5054016)

			if Other_Plr_Rank > 1 then

				local Alert = Instance.new("Sound")
				Alert.Volume = 1
				Alert.SoundId = "rbxassetid://792323017"
				Alert:Play()
				Alert.Parent = Plr.PlayerGui
				Alert.Name = "Staff_Alert"
				game.Debris:AddItem(Alert, 12.576)

				game.StarterGui:SetCore("SendNotification", {

					Title = Other_Plr_Role,
					Text = Other_Plr.DisplayName .. " | @" .. Other_Plr.Name .. " | " .. Other_Plr.UserId,
					Icon = game.Players:GetUserThumbnailAsync(Other_Plr.UserId, Enum.ThumbnailType.HeadShot, Enum.ThumbnailSize.Size420x420),
					Duration = math.huge,
					Button1 = "Leave",
					Button2	= "Stay",
					Callback = Choose_Bindable_1

				})

			end

		end

		PlrJoined(PlrName)

	end)	

end)

-->> Save Yourself <<-- (PC ONLY!) (Soon I will add phone support)

game.UserInputService.InputBegan:Connect(function(Input, Chat)

	if Chat then return end

	if Input.KeyCode == Enum.KeyCode.E and Plr.Character:FindFirstChild("HumanoidRootPart") and Plr.Character.Humanoid.Health ~= 0 then

		Plr.Character.Humanoid:ChangeState(Enum.HumanoidStateType.Ragdoll)

		local Fling_Force = Instance.new("BodyVelocity")
		Fling_Force.Velocity = Camera.CFrame.LookVector.Unit * 25 + Vector3.new(0, 15, 0)
		Fling_Force.MaxForce = Vector3.new(math.huge, math.huge, math.huge)
		Fling_Force.Name = "Fling_Force"
		Fling_Force.Parent = Plr.Character.HumanoidRootPart
		game.Debris:AddItem(Fling_Force, 1)

		local Fling_Spin = Instance.new("BodyAngularVelocity")
		Fling_Spin.AngularVelocity = Vector3.new(5, 5, 5)
		Fling_Spin.MaxTorque = Vector3.new(math.huge, math.huge, math.huge)
		Fling_Spin.Name = "Fling_Spin"
		Fling_Spin.Parent = Plr.Character.HumanoidRootPart
		game.Debris:AddItem(Fling_Spin, 1)

		task.wait(2)

		Plr.Character.Humanoid:ChangeState(Enum.HumanoidStateType.GettingUp)

	end

end)
